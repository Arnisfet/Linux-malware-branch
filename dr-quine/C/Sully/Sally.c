#include<stdio.h>
#include<stdlib.h>
#include<string.h>

#define SOURCE "#include<stdio.h>%1$c#include<stdlib.h>%1$c#include<string.h>%1$c%1$c#define SOURCE %3$c%4$s%3$c%1$c%1$cint main()%1$c{%1$c%1$c%2$cint i = 5;%1$c%2$c char cur_file[100];%1$c%2$cchar new_exec_file[100];%1$c%2$cchar src[100];%1$c%2$cchar compile_cmd[100];%1$c%2$cchar execute[100];%1$c%1$c%2$csprintf(cur_file, %3$cSully_%%d.c%3$c, i);%1$c%2$cif (strcmp(cur_file, __FILE__)) i--;%1$c%2$c"

int main()
{
  int i = 5;
  char cur_file[100];
  char new_exec_file[100];
  char src[100];
  char compile_cmd[100];
  char execute[100];

  sprintf(cur_file, "Sully_%d.c", i);
  if (strcmp(cur_file, __FILE__)) i--;
  sprintf(src, "Sully_%d.c", i);
  sprintf(new_exec_file, "Sully_%d", i);
  FILE *f = fopen(src, "w");
  if (f == NULL) return 1;
  fprintf(f, SOURCE, 10, 9, 34, SOURCE, i);
  sprintf(compile_cmd, "gcc %s -o %s", src, new_exec_file);
  system(compile_cmd);
  sprintf(execute, "./%s", new_exec_file);
  system(execute);
} 
