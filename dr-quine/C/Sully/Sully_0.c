#include<stdio.h>
#include<stdlib.h>
#include<string.h>

#define SOURCE "#include<stdio.h>%1$c#include<stdlib.h>%1$c#include<string.h>%1$c%1$c#define SOURCE %3$c%4$s%3$c%1$c%1$cint main()%1$c{%1$c%1$c%2$cint i = %5$d;%1$c%2$cchar cur_file[100];%1$c%2$cchar new_exec_file[100];%1$c%2$cchar src[100];%1$c%2$cchar compile_cmd[300];%1$c%2$cchar execute[200];%1$c%1$c%2$csprintf(cur_file, %3$cSully_%%d.c%3$c, i);%1$c%2$cif (i <= 0) return 0;%1$c%2$cif (!(strcmp(cur_file, __FILE__))) i--;%1$c%2$csprintf(src, %3$cSully_%%d.c%3$c, i);%1$c%2$csprintf(new_exec_file, %3$cSully_%%d%3$c, i);%1$c%2$cFILE *f = fopen(src, %3$cw%3$c);%1$c%2$cif (f == NULL) return 1;%1$c%2$cfprintf(f, SOURCE, 10, 9, 34, SOURCE, i);%1$c%2$cfclose(f);%1$c%2$csprintf(compile_cmd, %3$cgcc %%s -o %%s%3$c, src, new_exec_file);%1$c%2$csystem(compile_cmd);%1$c%2$csprintf(execute, %3$c./%%s%3$c, new_exec_file);%1$c%2$csystem(execute);%1$c}%1$c"

int main()
{

	int i = 0;
	char cur_file[100];
	char new_exec_file[100];
	char src[100];
	char compile_cmd[300];
	char execute[200];

	sprintf(cur_file, "Sully_%d.c", i);
	if (i <= 0) return 0;
	if (!(strcmp(cur_file, __FILE__))) i--;
	sprintf(src, "Sully_%d.c", i);
	sprintf(new_exec_file, "Sully_%d", i);
	FILE *f = fopen(src, "w");
	if (f == NULL) return 1;
	fprintf(f, SOURCE, 10, 9, 34, SOURCE, i);
	fclose(f);
	sprintf(compile_cmd, "gcc %s -o %s", src, new_exec_file);
	system(compile_cmd);
	sprintf(execute, "./%s", new_exec_file);
	system(execute);
}
